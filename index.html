<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>saumon@terminal</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üíª</text></svg>">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            height: 100%;
            background: #000;
            color: #9fff9f;
            font-family: 'Courier Prime', 'Courier New', monospace;
            font-size: 20px;
            line-height: 1.4;
            overflow: hidden;
            filter: contrast(1.2) brightness(1.1);
            text-shadow: 0 0 5px #9fff9f, 0 0 10px #9fff9f, 0 0 15px #9fff9f;
        }

        /* Permettre le scroll sur mobile et fixer la hauteur */
        @media screen and (max-width: 768px) {
            body, html {
                overflow: hidden; /* Pas de scroll sur body/html */
                height: 100vh;
                max-height: 100vh;
                position: fixed; /* Emp√™che le redimensionnement */
                width: 100%;
            }
        }

        .terminal {
            width: 100%;
            height: 100%;
            padding: 10px;
            background: #000;
            position: relative;
            display: flex;
            flex-direction: column;
            filter: blur(0.3px);
            overflow-y: auto;
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* Internet Explorer 10+ */
        }

        .terminal::-webkit-scrollbar {
            display: none; /* Safari et Chrome */
        }

        .output-container {
            flex: 1;
            overflow-y: auto;
            padding: 0 15px 20px 15px;
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* Internet Explorer 10+ */
        }

        .output-container::-webkit-scrollbar {
            display: none; /* Safari et Chrome */
        }

        .command-line {
            margin: 5px 0;
            display: flex;
            flex-wrap: wrap;
        }

        .command-block {
            margin: 10px 0;
            border-bottom: none;
            padding-bottom: 5px;
            opacity: 1; /* Luminosit√© normale par d√©faut */
            transition: opacity 0.3s ease; /* Animation fluide lors des changements */
        }

        .command-output {
            color: #9fff9f;
            margin: 2px 0;
            font-style: italic;
        }

        .input-line {
            display: flex;
            align-items: center;
            margin: 10px 0;
            position: relative;
            padding: 10px 0;
            border-bottom: none;
        }

        .command-input {
            background: transparent;
            border: none;
            color: #9fff9f;
            font-family: 'Courier Prime', 'Courier New', monospace;
            font-size: 20px;
            outline: none;
            flex: 1;
            caret-color: transparent;
            padding-left: 15px; /* Espace pour le curseur */
            text-transform: uppercase;
        }

        .command-input:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .terminal::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(159, 255, 159, 0.03) 2px,
                rgba(159, 255, 159, 0.03) 4px
            );
            pointer-events: none;
            z-index: 1000;
        }

        .terminal::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(ellipse at center, transparent 40%, rgba(0, 0, 0, 0.3) 100%),
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 1px,
                    rgba(255, 255, 255, 0.02) 1px,
                    rgba(255, 255, 255, 0.02) 2px
                );
            pointer-events: none;
            z-index: 1001;
            animation: crt-flicker 0.15s infinite linear alternate;
        }

        /* Couche de bruit suppl√©mentaire */
        .crt-screen::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(159, 255, 159, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(159, 255, 159, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(159, 255, 159, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 999;
            animation: noise-move 2s infinite linear;
        }

        @keyframes noise-move {
            0% { transform: translate(0px, 0px); }
            25% { transform: translate(-2px, 1px); }
            50% { transform: translate(1px, -1px); }
            75% { transform: translate(-1px, -2px); }
            100% { transform: translate(0px, 0px); }
        }

        .static-noise {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            pointer-events: none;
            z-index: 1002;
            opacity: 0.08; /* Augment√© de 0.03 √† 0.08 */
        }

        .static-noise::before {
            content: '';
            position: absolute;
            top: -100%;
            left: -100%;
            width: 300%;
            height: 300%;
            background-image: 
                repeating-linear-gradient(
                    0deg,
                    transparent 0px,
                    rgba(255, 255, 255, 0.1) 1px,
                    transparent 2px
                ),
                repeating-linear-gradient(
                    90deg,
                    transparent 0px,
                    rgba(255, 255, 255, 0.05) 1px,
                    transparent 3px
                );
            animation: static-drift 0.1s infinite linear;
        }

        @keyframes static-drift {
            0% { transform: translate(0px, 0px) rotate(0deg); }
            100% { transform: translate(-10px, -10px) rotate(0.5deg); }
        }

        /* Effet de brouillage analogique */
        .snow-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1003;
            opacity: 0.15; /* Augment√© de 0.06 √† 0.15 */
            mix-blend-mode: screen;
        }

        .snow-overlay::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
            animation: analog-noise 0.06s infinite steps(15); /* Plus rapide et plus d'√©tapes */
        }

        @keyframes analog-noise {
            0% { transform: translate(0px, 0px); opacity: 0.5; }
            6.66% { transform: translate(-1.5px, 1px); opacity: 0.9; }
            13.33% { transform: translate(1px, -1.5px); opacity: 0.3; }
            20% { transform: translate(-1px, -1px); opacity: 1.0; }
            26.66% { transform: translate(1.5px, 1px); opacity: 0.6; }
            33.33% { transform: translate(-1px, 0px); opacity: 0.8; }
            40% { transform: translate(1px, 0px); opacity: 0.4; }
            46.66% { transform: translate(0px, -1.5px); opacity: 0.9; }
            53.33% { transform: translate(0px, 1px); opacity: 0.7; }
            60% { transform: translate(-1.5px, 1px); opacity: 1.0; }
            66.66% { transform: translate(1px, -1px); opacity: 0.4; }
            73.33% { transform: translate(-0.5px, 0.5px); opacity: 0.8; }
            80% { transform: translate(0.5px, -0.5px); opacity: 0.6; }
            86.66% { transform: translate(-1px, 1.5px); opacity: 0.9; }
            93.33% { transform: translate(1px, -0.5px); opacity: 0.5; }
            100% { transform: translate(0px, 0px); opacity: 0.7; }
        }

        /* Lignes d'interf√©rence horizontales ondulantes */
        .interference-lines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                0deg,
                transparent 98%,
                rgba(255, 255, 255, 0.06) 98.5%,
                rgba(255, 255, 255, 0.12) 99%,
                rgba(255, 255, 255, 0.06) 99.5%,
                transparent 100%
            );
            background-size: 100% 8px;
            opacity: 0.8;
            pointer-events: none;
            z-index: 1004;
            animation: interference-roll 3.2s infinite linear,
                       interference-wave 1.1s infinite ease-in-out;
        }

        @keyframes interference-roll {
            0% { transform: translateY(-8px); }
            100% { transform: translateY(100vh); }
        }

        @keyframes interference-wave {
            0% { 
                opacity: 0.8; 
                filter: blur(0px);
                transform: scaleX(1);
            }
            25% { 
                opacity: 0.9; 
                filter: blur(0.2px);
                transform: scaleX(1.01);
            }
            50% { 
                opacity: 0.7; 
                filter: blur(0px);
                transform: scaleX(0.99);
            }
            75% { 
                opacity: 0.85; 
                filter: blur(0.1px);
                transform: scaleX(1.005);
            }
            100% { 
                opacity: 0.8; 
                filter: blur(0px);
                transform: scaleX(1);
            }
        }

        /* Effet de neige TV */
        .tv-snow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1005;
            opacity: 0.10;
            mix-blend-mode: screen;
            background: transparent;
        }

        .tv-snow::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle, 
                rgba(255, 255, 255, 0.9) 1px, 
                transparent 1px);
            background-size: 3px 3px;
            animation: tv-snow-fall 0.05s infinite linear;
        }

        .tv-snow::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle, 
                rgba(255, 255, 255, 0.7) 1px, 
                transparent 1px);
            background-size: 5px 5px;
            animation: tv-snow-fall-reverse 0.08s infinite linear;
        }

        @keyframes tv-snow-fall {
            0% { 
                transform: translate(0px, 0px) rotate(0deg);
                background-position: 0px 0px, 1px 1px;
            }
            25% { 
                transform: translate(-1px, 1px) rotate(0.5deg);
                background-position: -2px 2px, 3px -1px;
            }
            50% { 
                transform: translate(1px, -1px) rotate(-0.5deg);
                background-position: 1px -1px, -2px 3px;
            }
            75% { 
                transform: translate(-0.5px, 0.5px) rotate(0.2deg);
                background-position: 3px 1px, 1px -2px;
            }
            100% { 
                transform: translate(0px, 0px) rotate(0deg);
                background-position: 0px 0px, 1px 1px;
            }
        }

        @keyframes tv-snow-fall-reverse {
            0% { 
                transform: translate(0px, 0px) rotate(0deg);
                background-position: 0px 0px;
            }
            33% { 
                transform: translate(1px, -1px) rotate(-0.3deg);
                background-position: 2px -2px;
            }
            66% { 
                transform: translate(-1px, 1px) rotate(0.3deg);
                background-position: -1px 2px;
            }
            100% { 
                transform: translate(0px, 0px) rotate(0deg);
                background-position: 0px 0px;
            }
        }

        @keyframes crt-flicker {
            0% {
                opacity: 1;
            }
            98% {
                opacity: 1;
            }
            99% {
                opacity: 0.98;
            }
            100% {
                opacity: 0.99;
            }
        }

        .crt-screen {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 
                inset 0 0 50px rgba(159, 255, 159, 0.1),
                0 0 100px rgba(0, 0, 0, 0.8);
            background: radial-gradient(ellipse at center, #001100 0%, #000000 100%);
            /* Effet d'√©cran bomb√© */
            transform: perspective(800px) rotateX(2deg) rotateY(0deg);
            transform-style: preserve-3d;
        }

        /* Effet de courbure sur le contenu */
        .crt-screen .terminal {
            transform: perspective(1000px) rotateX(-1deg);
            border-radius: 20px;
            /* Distorsion barrel pour simuler l'√©cran bomb√© */
            filter: 
                blur(0.3px) 
                contrast(1.2) 
                brightness(1.1)
                url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg"><defs><filter id="barrel"><feOffset dx="0" dy="0"/><feGaussianBlur stdDeviation="0.5"/><feComponentTransfer><feFuncA type="discrete" tableValues="0 .5 .7 .8 .9 1"/></feComponentTransfer></filter></defs></svg>#barrel');
        }

        .crt-screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%),
                linear-gradient(90deg, rgba(159, 255, 159, 0.02), rgba(159, 255, 159, 0.01), rgba(159, 255, 159, 0.02));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
            z-index: 1002;
        }

        .terminal-header {
            color: #9fff9f;
            margin-bottom: 20px;
            border-bottom: 1px solid #9fff9f;
            padding-bottom: 10px;
            padding-left: 15px;
        }

        .boot-sequence {
            color: #9fff9f;
            margin-bottom: 20px;
            padding-left: 15px;
            transition: opacity 0.5s ease-out; /* Animation de disparition fluide */
        }

        /* Le boot-sequence h√©rite maintenant du scroll de command-history */
        @media screen and (max-width: 768px) {
            .boot-sequence {
                /* Pas de max-height ni overflow sp√©cifique - utilise le scroll parent */
                margin-bottom: 10px;
            }
        }

        .boot-line {
            opacity: 0;
            animation: fadeIn 0.5s ease-in forwards;
        }

        .boot-line:nth-child(1) { animation-delay: 0.2s; }
        .boot-line:nth-child(2) { animation-delay: 0.6s; }
        .boot-line:nth-child(3) { animation-delay: 1.0s; }
        .boot-line:nth-child(4) { animation-delay: 1.4s; }
        .boot-line:nth-child(5) { animation-delay: 1.8s; }

        .prompt-line {
            display: flex;
            align-items: center;
            margin-top: auto;
        }

        .prompt {
            color: #9fff9f;
            white-space: nowrap;
        }

        .user {
            color: #9fff9f;
        }

        .hostname {
            color: #9fff9f;
        }

        .path {
            color: #9fff9f;
        }

        .cursor {
            width: 10px;
            height: 20px;
            background: #9fff9f;
            position: absolute;
            left: 15px; /* Position de base align√©e avec le padding de l'input */
            top: 50%;
            transform: translateY(-50%); /* Centrage vertical parfait */
            animation: blink 1s infinite;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        @keyframes blink {
            0%, 50% {
                opacity: 1;
            }
            51%, 100% {
                opacity: 0;
            }
        }

        .glitch {
            position: relative;
        }

        .glitch::before,
        .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .glitch::before {
            animation: glitch-1 0.5s infinite;
            color: #9fff9f;
            z-index: -1;
        }

        .glitch::after {
            animation: glitch-2 0.5s infinite;
            color: #9fff9f;
            z-index: -2;
        }

        @keyframes glitch-1 {
            0%, 14%, 15%, 49%, 50%, 99%, 100% {
                transform: translate(0);
            }
            15%, 49% {
                transform: translate(-2px, 0);
            }
        }

        @keyframes glitch-2 {
            0%, 20%, 21%, 62%, 63%, 99%, 100% {
                transform: translate(0);
            }
            21%, 62% {
                transform: translate(2px, 0);
            }
        }

        .typewriter {
            overflow: hidden;
            border-right: 0.15em solid #9fff9f;
            white-space: nowrap;
            animation: typing 3.5s steps(40, end), blink-caret 0.75s step-end infinite;
        }

        @keyframes typing {
            from {
                width: 0;
            }
            to {
                width: 100%;
            }
        }

        @keyframes blink-caret {
            from, to {
                border-color: transparent;
            }
            50% {
                border-color: #9fff9f;
            }
        }

        .login-box {
            border: 2px solid #9fff9f;
            background: rgba(0, 0, 0, 0.8);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(159, 255, 159, 0.3);
            min-width: 300px;
            text-align: center;
        }

        /* Optimisations pour mobile */
        @media screen and (max-width: 768px) {
            .login-box {
                padding: 20px;
                min-width: 280px;
                margin: 0 10px;
                position: relative;
                top: 0;
            }
            
            .login-header {
                font-size: 20px;
                margin-bottom: 20px;
                padding-bottom: 10px;
            }
            
            .password-label {
                font-size: 14px;
            }
        }

        /* Ajustements sp√©cifiques pour √©viter le clavier mobile */
        @media screen and (max-height: 500px) {
            .login-box {
                padding: 15px;
                margin-top: 20px;
            }
            
            .login-header {
                font-size: 18px;
                margin-bottom: 15px;
            }
        }

        .login-header {
            color: #9fff9f;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 30px;
            border-bottom: 1px solid #9fff9f;
            padding-bottom: 15px;
        }

        .login-content {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .password-label {
            color: #9fff9f;
            font-size: 16px;
            text-align: left;
        }

        .password-field {
            display: flex;
            align-items: center;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #9fff9f;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier Prime', 'Courier New', monospace;
            font-size: 16px;
            min-height: 20px;
        }

        #password-display {
            color: #9fff9f;
            letter-spacing: 2px;
        }

        .login-cursor {
            color: #9fff9f;
            animation: blink-cursor 1s infinite;
            margin-left: 2px;
        }

        @keyframes blink-cursor {
            0%, 50% {
                opacity: 1;
            }
            51%, 100% {
                opacity: 0;
            }
        }

        .login-error {
            color: #ff6b6b !important;
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid #ff6b6b;
            padding: 10px;
            border-radius: 4px;
            margin-top: 15px;
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .help-commands {
            margin-top: 10px;
        }

        .help-command {
            display: flex;
            margin-bottom: 2px;
            margin-left: 2ch; /* Indentation */
        }

        .cmd-name {
            min-width: 10ch; /* Largeur r√©duite pour les noms de commandes */
            color: #9fff9f;
            flex-shrink: 0; /* Emp√™che la r√©duction */
        }

        .cmd-desc {
            color: #9fff9f;
            word-wrap: break-word;
            padding-left: 0.2ch; /* Espacement ultra-minimal entre commande et description */
        }

        /* Responsive pour petits √©crans */
        @media (max-width: 768px) {
            .help-command {
                display: flex;
                flex-direction: row;
                margin-bottom: 2px;
                margin-left: 0.25ch;
            }
            
            .cmd-name {
                min-width: 9ch;
                flex-shrink: 0;
            }
            
            .cmd-desc {
                padding-left: 0.1ch;
                flex: 1;
            }
        }

        /* Pour tr√®s petits √©crans */
        @media (max-width: 480px) {
            .help-command {
                margin-left: 0.125ch;
            }
            
            .cmd-name {
                min-width: 8ch;
            }
            
            .cmd-desc {
                padding-left: 0.1ch;
            }
        }

        /* R√©duction de la taille de police pour mobile */
        @media screen and (max-width: 768px) {
            body, html {
                font-size: 18px;
            }
            
            .help-commands {
                margin-top: 8px;
            }
            
            /* Ajustements du curseur et de l'input pour mobile */
            .cursor {
                width: 0.5em;
                height: 1em;
                left: 0;
                top: 50%;
                transform: translateY(-50%);
            }
            
            .command-input {
                font-size: 18px;
                line-height: 1.4;
                padding-left: 0;
            }
        }

        /* Pour tr√®s petits √©crans - encore plus compact */
        @media screen and (max-width: 480px) {
            body, html {
                font-size: 16px;
            }
            
            /* Ajustements suppl√©mentaires du curseur pour tr√®s petits √©crans */
            .cursor {
                width: 0.45em;
                height: 1em;
                left: 0;
                top: 50%;
                transform: translateY(-50%);
            }
            
            .command-input {
                font-size: 16px;
                padding-left: 0;
            }
        }

        /* Gestion du clavier mobile */
        @media screen and (max-width: 768px) {
            .crt-screen {
                position: fixed; /* Ancrage en position fixe */
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                height: 100vh; /* Hauteur fixe de l'√©cran complet */
                max-height: 100vh;
                overflow: hidden;
            }
            
            .terminal {
                height: 100%; /* Prend toute la hauteur du conteneur parent */
                max-height: 100%;
                overflow: hidden;
                position: relative; /* Position relative dans son conteneur */
            }
            
            .input-line {
                position: sticky; /* Reste en haut apr√®s le header */
                top: 0;
                background: rgba(0, 0, 0, 0.95);
                backdrop-filter: blur(10px);
                padding: 15px;
                margin: 0;
                z-index: 1000;
                border-bottom: none;
                border-top: none;
            }
            
            .output-container {
                flex: 1;
                overflow-y: auto;
                scroll-behavior: smooth;
                padding: 15px;
            }
        }

        /* Support iOS Safari pour le clavier */
        @supports (padding: max(0px)) {
            @media screen and (max-width: 768px) {
                .output-container {
                    padding-bottom: max(15px, env(safe-area-inset-bottom));
                }
            }
        }
    </style>
</head>
<body>
    <div class="crt-screen">
        <div class="static-noise"></div>
        <div class="snow-overlay"></div>
        <div class="interference-lines"></div>
        <div class="tv-snow"></div>
        <div class="terminal">
            <div class="terminal-header">
                <div class="glitch" data-text="SAUMON TERMINAL v1.1.4">SAUMON TERMINAL v1.1.4</div>
                <div>Copyright (C) 2025 Saumon Corporation. All rights reserved.</div>
            </div>
            
            <!-- Prompt en haut, juste apr√®s le header -->
            <div class="input-line">
                <input type="text" class="command-input" id="command-input" autofocus disabled 
                       autocomplete="off" 
                       autocorrect="off" 
                       autocapitalize="off" 
                       spellcheck="false"
                       inputmode="text">
                <div class="cursor"></div>
            </div>
            
            <!-- Historique des commandes qui d√©file vers le bas -->
            <div class="output-container" id="output-container">
                <div class="boot-sequence">
                    <div class="boot-line">Initializing system...</div>
                    <div class="boot-line">Loading kernel modules... [OK]</div>
                    <div class="boot-line">Starting network services... [OK]</div>
                    <div class="boot-line">Mounting filesystems... [OK]</div>
                    <div class="boot-line">System ready.</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let commandHistoryArray = [];
        let historyIndex = -1;
        let isLoginMode = false;
        let isBootLoading = true; // D√©marrer en mode boot au chargement initial
        let commandInput = document.getElementById('command-input');
        let commandOutput = document.getElementById('output-container');
        let cursor = document.querySelector('.cursor');

        // Fonction pour jouer un bip
        function playBeep() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            // Bip oldschool : fr√©quence plus basse, son plus carr√©
            oscillator.type = 'square';
            oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.08);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.08);
        }

        // Fonction pour jouer un double bip d'erreur
        function playErrorBeep() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            // Premier bip
            const oscillator1 = audioContext.createOscillator();
            const gainNode1 = audioContext.createGain();
            oscillator1.connect(gainNode1);
            gainNode1.connect(audioContext.destination);
            oscillator1.type = 'square';
            oscillator1.frequency.setValueAtTime(200, audioContext.currentTime);
            gainNode1.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode1.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.06);
            oscillator1.start(audioContext.currentTime);
            oscillator1.stop(audioContext.currentTime + 0.06);
            
            // Deuxi√®me bip (d√©cal√© de 0.08s)
            const oscillator2 = audioContext.createOscillator();
            const gainNode2 = audioContext.createGain();
            oscillator2.connect(gainNode2);
            gainNode2.connect(audioContext.destination);
            oscillator2.type = 'square';
            oscillator2.frequency.setValueAtTime(200, audioContext.currentTime + 0.08);
            gainNode2.gain.setValueAtTime(0.3, audioContext.currentTime + 0.08);
            gainNode2.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.14);
            oscillator2.start(audioContext.currentTime + 0.08);
            oscillator2.stop(audioContext.currentTime + 0.14);
        }

        // Fonction pour afficher l'√©cran de login
        function showLoginScreen() {
            isLoginMode = true;
            const terminal = document.querySelector('.terminal');
            terminal.innerHTML = `
                <div style="display: flex; justify-content: center; align-items: flex-start; height: 100vh; padding-top: min(10vh, 60px);">
                    <div class="login-box">
                        <div class="login-header">LOGIN</div>
                        <div class="login-content">
                            <div class="password-label">Password:</div>
                            <div class="password-field">
                                <span id="password-display"></span><span id="cursor-login" class="login-cursor">‚ñà</span>
                            </div>
                        </div>
                    </div>
                </div>
                <input type="password" id="password-input" maxlength="10" 
                       style="position: absolute; left: -9999px; opacity: 0;" 
                       autocomplete="current-password"
                       inputmode="text">
            `;
            
            // Attendre que le DOM soit mis √† jour
            setTimeout(() => {
                setupPasswordInput();
            }, 50);
        }

        // Fonction pour configurer l'input du mot de passe
        function setupPasswordInput() {
            const passwordInput = document.getElementById('password-input');
            const passwordDisplay = document.getElementById('password-display');
            const cursorLogin = document.getElementById('cursor-login');
            const terminal = document.querySelector('.terminal');
            
            if (!passwordInput || !passwordDisplay || !cursorLogin) return;
            
            // Configurer les attributs pour √©viter l'interf√©rence mobile
            passwordInput.setAttribute('autocomplete', 'current-password');
            passwordInput.setAttribute('autocorrect', 'off');
            passwordInput.setAttribute('autocapitalize', 'off');
            passwordInput.setAttribute('spellcheck', 'false');
            
            // Fonction pour maintenir le focus sur l'input de mot de passe (uniquement en mode login)
            function maintainFocus() {
                if (isLoginMode && passwordInput && document.activeElement !== passwordInput) {
                    // Petit d√©lai pour √©viter les conflits avec les √©v√©nements mobiles
                    setTimeout(() => {
                        if (isLoginMode) {
                            passwordInput.focus();
                        }
                    }, 50);
                }
            }
            
            // Gestionnaires pour maintenir le focus (moins agressifs sur mobile)
            document.addEventListener('click', maintainFocus);
            passwordInput.addEventListener('blur', function() {
                // D√©lai plus long pour permettre aux √©v√©nements mobiles de se stabiliser
                setTimeout(maintainFocus, 100);
            });
            
            // Fonction pour mettre √† jour l'affichage du mot de passe
            function updatePasswordDisplay() {
                const inputLength = passwordInput.value.length;
                const dots = '‚Ä¢'.repeat(inputLength);
                passwordDisplay.textContent = dots;
            }
            
            passwordInput.addEventListener('input', updatePasswordDisplay);
            
            passwordInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const password = passwordInput.value.trim();
                    
                    if (password.toLowerCase() === 'saumon') {
                        playBeep();
                        restoreTerminal();
                    } else {
                        playErrorBeep();
                        passwordInput.value = '';
                        updatePasswordDisplay();
                        
                        // Supprimer les anciens messages d'erreur
                        const oldErrors = terminal.querySelectorAll('.login-error');
                        oldErrors.forEach(error => error.remove());
                        
                        // Ajouter le nouveau message d'erreur dans la login-box
                        const loginBox = terminal.querySelector('.login-box');
                        if (loginBox) {
                            const errorDiv = document.createElement('div');
                            errorDiv.className = 'login-error';
                            errorDiv.textContent = 'ACCESS DENIED';
                            loginBox.appendChild(errorDiv);
                        }
                    }
                }
            });
            
            // Initialiser l'affichage
            updatePasswordDisplay();
            passwordInput.focus();
            
            // Stocker les r√©f√©rences pour pouvoir les supprimer plus tard
            passwordInput._maintainFocus = maintainFocus;
        }

        // Fonction pour nettoyer les gestionnaires d'√©v√©nements du login
        function cleanupLoginEventListeners() {
            const passwordInput = document.getElementById('password-input');
            if (passwordInput && passwordInput._maintainFocus) {
                document.removeEventListener('click', passwordInput._maintainFocus);
                document.removeEventListener('focusin', passwordInput._maintainFocus);
            }
        }

        // Fonction pour restaurer le terminal normal
        function restoreTerminal() {
            // Nettoyer les gestionnaires d'√©v√©nements du login
            cleanupLoginEventListeners();
            
            isLoginMode = false;
            isBootLoading = true;
            const terminal = document.querySelector('.terminal');
            terminal.innerHTML = `
                <div class="terminal-header">
                    <div class="glitch" data-text="SAUMON TERMINAL v1.1.4">SAUMON TERMINAL v1.1.4</div>
                    <div>Copyright (C) 2025 Saumon Corporation. All rights reserved.</div>
                </div>
                
                <!-- Prompt en haut, juste apr√®s le header -->
                <div class="input-line">
                    <input type="text" class="command-input" id="command-input" autofocus disabled maxlength="20">
                    <div class="cursor"></div>
                </div>
                
                <!-- Historique des commandes qui d√©file vers le bas -->
                <div class="output-container" id="output-container">
                    <div class="boot-sequence">
                        <div class="boot-line">Initializing system...</div>
                        <div class="boot-line">Loading kernel modules... [OK]</div>
                        <div class="boot-line">Starting network services... [OK]</div>
                        <div class="boot-line">Mounting filesystems... [OK]</div>
                        <div class="boot-line">System ready.</div>
                    </div>
                </div>
            `;
            
            // Attendre la fin de l'animation de boot (5 lignes * 0.4s d√©lai + 1s suppl√©mentaire)
            setTimeout(() => {
                isBootLoading = false;
                
                // Masquer la s√©quence de boot avec animation fluide
                const bootSequence = document.querySelector('.boot-sequence');
                if (bootSequence) {
                    bootSequence.style.opacity = '0';
                    setTimeout(() => {
                        bootSequence.style.display = 'none';
                    }, 500); // Attendre la fin de la transition
                }
                
                const bootInput = document.getElementById('command-input');
                if (bootInput) {
                    bootInput.disabled = false;
                }
                setupMainTerminal();
            }, 3000); // 3 secondes pour laisser le temps au boot de se terminer
        }

        // Fonction pour configurer le terminal principal
        function setupMainTerminal() {
            const newCommandInput = document.getElementById('command-input');
            const newCommandOutput = document.getElementById('output-container');
            const newCursor = document.querySelector('.cursor');
            
            if (!newCommandInput) return;
            
            // Configurer les attributs pour mobile
            newCommandInput.setAttribute('type', 'text');
            newCommandInput.setAttribute('autocomplete', 'off');
            newCommandInput.setAttribute('autocorrect', 'off');
            newCommandInput.setAttribute('autocapitalize', 'off');
            newCommandInput.setAttribute('spellcheck', 'false');
            newCommandInput.setAttribute('inputmode', 'text');
            
            // Mettre √† jour les r√©f√©rences globales
            commandInput = newCommandInput;
            commandOutput = newCommandOutput;
            cursor = newCursor;
            
            // Gestion de la saisie de commandes
            newCommandInput.addEventListener('keydown', function(e) {
                if (isLoginMode || isBootLoading) return;
                
                // V√©rifier la limite de caract√®res pour les touches de saisie
                if (e.key.length === 1 && newCommandInput.value.length >= 20) {
                    e.preventDefault();
                    playErrorBeep();
                    return;
                }
                
                if (e.key === 'Enter') {
                    const command = newCommandInput.value.trim();
                    if (command) {
                        executeCommand(command);
                        newCommandInput.value = '';
                        historyIndex = -1;
                    }
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (historyIndex < commandHistoryArray.length - 1) {
                        historyIndex++;
                        const historyCommand = commandHistoryArray[commandHistoryArray.length - 1 - historyIndex] || '';
                        newCommandInput.value = historyCommand.substring(0, 20); // Tronquer si n√©cessaire
                    }
                } else if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    if (historyIndex > 0) {
                        historyIndex--;
                        const historyCommand = commandHistoryArray[commandHistoryArray.length - 1 - historyIndex] || '';
                        newCommandInput.value = historyCommand.substring(0, 20); // Tronquer si n√©cessaire
                    } else if (historyIndex === 0) {
                        historyIndex = -1;
                        newCommandInput.value = '';
                    }
                }
            });

            // Maintenir le focus
            document.addEventListener('click', () => {
                if (!isLoginMode) {
                    newCommandInput.focus();
                }
            });

            // Positionner le curseur
            function updateCursorPosition() {
                const text = newCommandInput.value.toUpperCase(); // Tenir compte du text-transform
                
                // M√©thode plus pr√©cise: utiliser un √©l√©ment temporaire
                const measureElement = document.createElement('span');
                measureElement.style.fontFamily = 'Courier Prime, Courier New, monospace';
                measureElement.style.visibility = 'hidden';
                measureElement.style.position = 'absolute';
                measureElement.style.whiteSpace = 'pre';
                
                // Adapter la taille de police selon la taille d'√©cran
                if (window.innerWidth <= 480) {
                    measureElement.style.fontSize = '16px';
                } else if (window.innerWidth <= 768) {
                    measureElement.style.fontSize = '18px';
                } else {
                    measureElement.style.fontSize = '20px';
                }
                
                measureElement.textContent = text;
                document.body.appendChild(measureElement);
                const textWidth = measureElement.offsetWidth;
                document.body.removeChild(measureElement);
                
                newCursor.style.left = (15 + textWidth) + 'px';
            }

            newCommandInput.addEventListener('input', () => {
                // V√©rifier la limite de 20 caract√®res
                if (newCommandInput.value.length > 20) {
                    newCommandInput.value = newCommandInput.value.substring(0, 20);
                    playErrorBeep();
                }
                updateCursorPosition();
            });

            newCommandInput.addEventListener('keydown', () => {
                setTimeout(updateCursorPosition, 0);
            });

            updateCursorPosition();
            newCommandInput.focus(); // S'assurer que le focus est sur l'input
            
            // Gestion du scroll mobile pour le clavier
            function scrollToPrompt() {
                if (window.innerWidth <= 768) { // Sur mobile/tablette
                    setTimeout(() => {
                        const inputLine = document.querySelector('.input-line');
                        if (inputLine) {
                            inputLine.scrollIntoView({ 
                                behavior: 'smooth', 
                                block: 'end',
                                inline: 'nearest'
                            });
                        }
                    }, 300); // D√©lai pour laisser le clavier s'ouvrir
                }
            }
            
            // √âv√©nements pour g√©rer le clavier mobile
            newCommandInput.addEventListener('focus', scrollToPrompt);
            newCommandInput.addEventListener('touchstart', scrollToPrompt, { passive: true });
        }

        // Gestion de la saisie
        commandInput.addEventListener('keydown', function(e) {
            if (isLoginMode) return; // Ignorer si on est en mode login
            
            // V√©rifier la limite de caract√®res pour les touches de saisie
            if (e.key.length === 1 && commandInput.value.length >= 20) {
                e.preventDefault();
                playErrorBeep();
                return;
            }
            
            if (e.key === 'Enter') {
                const command = commandInput.value.trim();
                if (command) {
                    executeCommand(command);
                    commandInput.value = '';
                    historyIndex = -1;
                }
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                if (historyIndex < commandHistoryArray.length - 1) {
                    historyIndex++;
                    commandInput.value = commandHistoryArray[commandHistoryArray.length - 1 - historyIndex] || '';
                }
            } else if (e.key === 'ArrowDown') {
                e.preventDefault();
                if (historyIndex > 0) {
                    historyIndex--;
                    commandInput.value = commandHistoryArray[commandHistoryArray.length - 1 - historyIndex] || '';
                } else if (historyIndex === 0) {
                    historyIndex = -1;
                    commandInput.value = '';
                }
            }
        });

        // Gestion de l'√©v√©nement input pour la limite de caract√®res (s√©curit√©)
        commandInput.addEventListener('input', function() {
            if (commandInput.value.length > 20) {
                commandInput.value = commandInput.value.substring(0, 20);
                playErrorBeep();
            }
        });

        // Fonction pour mettre √† jour la luminosit√© des commandes
        function updateCommandOpacity() {
            const commandBlocks = commandOutput.querySelectorAll('.command-block');
            commandBlocks.forEach((block, index) => {
                if (index === 0) {
                    block.style.opacity = '1'; // Derni√®re commande - luminosit√© maximale
                } else if (index === 1) {
                    block.style.opacity = '0.8'; // Pr√©c√©dente
                } else if (index === 2) {
                    block.style.opacity = '0.6'; // 3√®me
                } else if (index === 3) {
                    block.style.opacity = '0.5'; // 4√®me
                } else {
                    block.style.opacity = '0.4'; // 5√®me et suivantes
                }
            });
        }

        // Fonction helper pour ins√©rer un √©l√©ment en haut de la liste (apr√®s boot sequence)
        function insertAtTop(element) {
            const bootSequence = commandOutput.querySelector('.boot-sequence');
            if (bootSequence && bootSequence.style.display !== 'none') {
                // Ins√©rer apr√®s la boot sequence
                bootSequence.insertAdjacentElement('afterend', element);
            } else {
                // Ins√©rer au d√©but du conteneur
                commandOutput.insertBefore(element, commandOutput.firstChild);
            }
        }

        // Ex√©cution des commandes
        function executeCommand(command) {
            // Ajouter la commande √† l'historique
            commandHistoryArray.push(command);
            
            // Cr√©er un conteneur pour cette commande compl√®te
            const commandBlock = document.createElement('div');
            commandBlock.className = 'command-block';
            
            // Afficher la commande
            const commandLine = document.createElement('div');
            commandLine.className = 'command-line';
            commandLine.innerHTML = `<span>> ${command.toUpperCase()}</span>`;
            commandBlock.appendChild(commandLine);

            // Traiter la commande
            const output = document.createElement('div');
            output.className = 'command-output';
            
            if (command.toLowerCase() === 'help') {
                playBeep();
                output.innerHTML = `
                    <div>Available commands:</div>
                    <div class="help-commands">
                        <div class="help-command">
                            <span class="cmd-name">GOIS</span>
                            <span class="cmd-desc">open 'Passage du Gois' project</span>
                        </div>
                        <div class="help-command">
                            <span class="cmd-name">GIT</span>
                            <span class="cmd-desc">open 'GitKtti‚Ñ¢' project</span>
                        </div>
                        <div class="help-command">
                            <span class="cmd-name">FART</span>
                            <span class="cmd-desc">open 'Fart Simulator' repo</span>
                        </div>
                        <div class="help-command">
                            <span class="cmd-name">CLEAR</span>
                            <span class="cmd-desc">clear history</span>
                        </div>
                        <div class="help-command">
                            <span class="cmd-name">EXIT</span>
                            <span class="cmd-desc">logout</span>
                        </div>
                        <div class="help-command">
                            <span class="cmd-name">HELP</span>
                            <span class="cmd-desc">this help</span>
                        </div>
                    </div>
                `;
            } else if (command.toLowerCase() === 'gois') {
                playBeep();
                window.open('https://saumon.github.io/fr.passagedugois.app/', '_blank');
                output.textContent = `Opening passage du gois...`;
            } else if (command.toLowerCase() === 'git') {
                playBeep();
                window.open('https://saumon.github.io/gitktti/', '_blank');
                output.textContent = `Opening gitktti...`;
            } else if (command.toLowerCase() === 'fart') {
                playBeep();
                window.open('https://github.com/saumon/fartsimulator', '_blank');
                output.textContent = `Opening fart simulator...`;
            } else if (command.toLowerCase() === 'clear') {
                playBeep();
                // Effacer l'historique
                commandOutput.innerHTML = '';
                // Effacer la boot sequence uniquement
                const bootSequence = document.querySelector('.boot-sequence');
                if (bootSequence) bootSequence.style.display = 'none';
                // Ne pas ajouter de message de sortie pour clear
                commandOutput.scrollTop = commandOutput.scrollHeight;
                return; // Sortir de la fonction sans ajouter d'output ni de saut de ligne
            } else if (command.toLowerCase() === 'exit') {
                playBeep();
                showLoginScreen();
                return; // Sortir de la fonction sans ajouter d'output
            } else {
                playErrorBeep();
                output.textContent = `command not found. Need HELP?`;
            }
            
            // Ajouter la sortie au bloc de commande
            commandBlock.appendChild(output);

            // Ajouter un saut de ligne
            const lineBreak = document.createElement('div');
            lineBreak.innerHTML = '&nbsp;';
            commandBlock.appendChild(lineBreak);
            
            // Ins√©rer tout le bloc en haut
            insertAtTop(commandBlock);

            // Mettre √† jour la luminosit√© de toutes les commandes
            updateCommandOpacity();

            // Auto-scroll vers le haut pour voir la nouvelle commande
            commandOutput.scrollTop = 0;
        }

        // Maintenir le focus sur l'input
        document.addEventListener('click', () => {
            if (!isLoginMode) {
                commandInput.focus();
                // Scroll vers le prompt sur mobile
                if (window.innerWidth <= 768) {
                    setTimeout(() => {
                        const inputLine = document.querySelector('.input-line');
                        if (inputLine) {
                            inputLine.scrollIntoView({ 
                                behavior: 'smooth', 
                                block: 'end',
                                inline: 'nearest'
                            });
                        }
                    }, 100);
                }
            }
        });

        // Positionner le curseur apr√®s le texte
        function updateCursorPosition() {
            const text = commandInput.value.toUpperCase(); // Tenir compte du text-transform
            
            // M√©thode plus pr√©cise: utiliser un √©l√©ment temporaire
            const measureElement = document.createElement('span');
            measureElement.style.fontFamily = 'Courier Prime, Courier New, monospace';
            measureElement.style.visibility = 'hidden';
            measureElement.style.position = 'absolute';
            measureElement.style.whiteSpace = 'pre';
            
            // Adapter la taille de police selon la taille d'√©cran
            if (window.innerWidth <= 480) {
                measureElement.style.fontSize = '11px';
            } else if (window.innerWidth <= 768) {
                measureElement.style.fontSize = '12px';
            } else {
                measureElement.style.fontSize = '14px';
            }
            
            measureElement.textContent = text;
            document.body.appendChild(measureElement);
            const textWidth = measureElement.offsetWidth;
            document.body.removeChild(measureElement);
            
            cursor.style.left = (15 + textWidth) + 'px'; // 15px de padding + largeur du texte
        }

        commandInput.addEventListener('input', () => {
            updateCursorPosition();
        });

        // Repositionner le curseur lors du redimensionnement
        window.addEventListener('resize', () => {
            updateCursorPosition();
        });

        commandInput.addEventListener('keydown', () => {
            setTimeout(updateCursorPosition, 0); // D√©lai pour que la valeur soit mise √† jour
        });

        // Position initiale du curseur
        updateCursorPosition();

        // Effet de scintillement occasionnel plus intense
        setInterval(() => {
            if (Math.random() < 0.15) { // Plus fr√©quent
                document.body.style.filter = 'brightness(1.3) contrast(1.4) saturate(1.2)';
                setTimeout(() => {
                    document.body.style.filter = 'brightness(1.1) contrast(1.2)';
                }, Math.random() * 80 + 20); // Dur√©e variable
            }
        }, 80); // Plus fr√©quent

        // Effet de clignotement des lignes plus prononc√©
        setInterval(() => {
            const lines = document.querySelectorAll('.boot-line, .command-output, .help-command');
            const randomLine = lines[Math.floor(Math.random() * lines.length)];
            if (randomLine && Math.random() < 0.08) { // Plus fr√©quent
                randomLine.style.opacity = Math.random() * 0.5 + 0.3; // Opacit√© variable
                setTimeout(() => {
                    randomLine.style.opacity = '1';
                }, Math.random() * 150 + 50);
            }
        }, 150);

        // Simulation de bruit de fond CRT plus intense
        function addNoise() {
            const terminal = document.querySelector('.terminal');
            if (Math.random() < 0.05) { // Plus fr√©quent
                const intensity = Math.random() * 0.5 + 0.2;
                terminal.style.textShadow = `${intensity}px ${intensity}px 0px #9fff9f, 0 0 ${intensity * 30}px #9fff9f`;
                terminal.style.filter = `blur(${intensity}px) contrast(${1 + intensity})`;
                setTimeout(() => {
                    terminal.style.textShadow = 'none';
                    terminal.style.filter = 'blur(0.3px)';
                }, Math.random() * 50 + 20);
            }
        }

        // Effet de distorsion CRT plus visible
        function crtDistortion() {
            const screen = document.querySelector('.crt-screen');
            if (Math.random() < 0.03) { // Plus fr√©quent
                const scaleX = 1 + (Math.random() - 0.5) * 0.005;
                const scaleY = 1 + (Math.random() - 0.5) * 0.005;
                const rotate = (Math.random() - 0.5) * 0.5;
                screen.style.transform = `scale(${scaleX}, ${scaleY}) rotate(${rotate}deg)`;
                setTimeout(() => {
                    screen.style.transform = 'scale(1)';
                }, Math.random() * 200 + 50);
            }
        }

        // Nouveau: Artefacts de couleur occasionnels
        function colorArtifacts() {
            const terminal = document.querySelector('.terminal');
            if (Math.random() < 0.01) {
                const hue = Math.random() * 60 + 90; // Variations autour du vert
                terminal.style.filter = `hue-rotate(${hue}deg) saturate(1.5)`;
                setTimeout(() => {
                    terminal.style.filter = 'blur(0.3px)';
                }, Math.random() * 200 + 100);
            }
        }

        // Nouveau: G√©n√©rateur de bruit analogique intensifi√©
        function createAnalogNoise() {
            const noiseContainer = document.querySelector('.snow-overlay');
            let noiseActive = true;
            
            // Cr√©er une grille de pixels de bruit plus dense
            function generateNoiseFrame() {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = 120; // L√©g√®rement plus petit pour pixels plus gros
                canvas.height = 120;
                
                const imageData = ctx.createImageData(canvas.width, canvas.height);
                const data = imageData.data;
                
                // Densit√© de bruit plus √©lev√©e
                const noiseDensity = Math.random() * 0.4 + 0.25; // Entre 25% et 65% des pixels
                
                for (let i = 0; i < data.length; i += 4) {
                    if (Math.random() < noiseDensity) {
                        const noise = Math.random() * 255;
                        const alpha = Math.random() * 0.35 + 0.1; // Plus opaque: 0.1 √† 0.45
                        
                        data[i] = noise;     // Rouge
                        data[i + 1] = noise; // Vert
                        data[i + 2] = noise; // Bleu
                        data[i + 3] = alpha * 255; // Alpha
                    } else {
                        // Pixel transparent
                        data[i] = 0;
                        data[i + 1] = 0;
                        data[i + 2] = 0;
                        data[i + 3] = 0;
                    }
                }
                
                ctx.putImageData(imageData, 0, 0);
                return canvas.toDataURL();
            }
            
            // Mettre √† jour le bruit plus rapidement
            function updateNoise() {
                if (!noiseActive) return;
                
                // Plus de chance de mise √† jour
                if (Math.random() < 0.85) { // 85% de chance au lieu de 70%
                    const dataUrl = generateNoiseFrame();
                    noiseContainer.style.backgroundImage = `url(${dataUrl})`;
                    noiseContainer.style.backgroundSize = `${Math.random() * 40 + 80}px ${Math.random() * 40 + 80}px`; // Pixels plus gros
                    noiseContainer.style.backgroundRepeat = 'repeat';
                }
                
                // Timing plus rapide
                const nextUpdate = Math.random() * 60 + 40; // Entre 40 et 100ms (plus rapide)
                setTimeout(updateNoise, nextUpdate);
            }
            
            // D√©marrer imm√©diatement
            updateNoise();
            
            // Pauses moins fr√©quentes
            setInterval(() => {
                if (Math.random() < 0.02) { // 2% de chance au lieu de 5%
                    noiseActive = false;
                    noiseContainer.style.backgroundImage = 'none';
                    setTimeout(() => {
                        noiseActive = true;
                    }, Math.random() * 300 + 100); // Pauses plus courtes
                }
            }, 3000); // Moins fr√©quent
            
            // Variations d'intensit√© plus fr√©quentes et plus fortes
            setInterval(() => {
                if (Math.random() < 0.15) { // Plus fr√©quent: 15% au lieu de 8%
                    noiseContainer.style.opacity = Math.random() * 0.25 + 0.1; // Entre 0.1 et 0.35 (plus intense)
                    setTimeout(() => {
                        noiseContainer.style.opacity = '0.15';
                    }, Math.random() * 300 + 150);
                }
            }, 500); // Plus fr√©quent
        }

        // G√©n√©rateur de neige TV r√©aliste
        function createTVSnow() {
            const tvSnow = document.querySelector('.tv-snow');
            if (!tvSnow) return;
            
            let snowActive = true;
            
            function generateSnowPattern() {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = 200;
                canvas.height = 200;
                
                const imageData = ctx.createImageData(canvas.width, canvas.height);
                const data = imageData.data;
                
                // Densit√© de neige r√©duite
                const snowDensity = Math.random() * 0.15 + 0.08; // Entre 8% et 23% des pixels (r√©duit)
                
                for (let i = 0; i < data.length; i += 4) {
                    if (Math.random() < snowDensity) {
                        const brightness = Math.random() * 255;
                        const alpha = Math.random() * 0.6 + 0.2; // Entre 0.2 et 0.8 (moins intense)
                        
                        data[i] = brightness;     // Rouge
                        data[i + 1] = brightness; // Vert
                        data[i + 2] = brightness; // Bleu
                        data[i + 3] = Math.min(255, alpha * 255); // Alpha (limit√© √† 255)
                    } else {
                        // Pixel transparent
                        data[i] = 0;
                        data[i + 1] = 0;
                        data[i + 2] = 0;
                        data[i + 3] = 0;
                    }
                }
                
                ctx.putImageData(imageData, 0, 0);
                return canvas.toDataURL();
            }
            
            function updateSnow() {
                if (!snowActive) return;
                
                if (Math.random() < 0.85) { // 85% de chance de mise √† jour (moins fr√©quent)
                    const dataUrl = generateSnowPattern();
                    tvSnow.style.backgroundImage = `url(${dataUrl})`;
                    tvSnow.style.backgroundSize = `${Math.random() * 20 + 80}px ${Math.random() * 20 + 80}px`;
                    tvSnow.style.backgroundRepeat = 'repeat';
                }
                
                // Timing plus lent pour effet de neige plus doux
                const nextUpdate = Math.random() * 40 + 25; // Entre 25 et 65ms (plus lent)
                setTimeout(updateSnow, nextUpdate);
            }
            
            // D√©marrer l'effet
            updateSnow();
            
            // Pauses occasionnelles de la neige (moins fr√©quentes)
            setInterval(() => {
                if (Math.random() < 0.02) { // 2% de chance (r√©duit pour plus de continuit√©)
                    snowActive = false;
                    tvSnow.style.backgroundImage = 'none';
                    setTimeout(() => {
                        snowActive = true;
                    }, Math.random() * 150 + 50); // Pause plus courte
                }
            }, 3000); // Moins fr√©quent
            
            // Variations d'intensit√© plus douces
            setInterval(() => {
                if (Math.random() < 0.12) { // 12% de chance (moins fr√©quent)
                    tvSnow.style.opacity = Math.random() * 0.15 + 0.06; // Entre 0.06 et 0.21 (moins intense)
                    setTimeout(() => {
                        tvSnow.style.opacity = '0.10'; // Opacit√© par d√©faut r√©duite
                    }, Math.random() * 300 + 200); // Dur√©e plus longue
                }
            }, 800); // Moins fr√©quent
        }

        // Effet de brouillage dynamique plus subtil
        function analogInterference() {
            const noiseOverlay = document.querySelector('.snow-overlay');
            if (Math.random() < 0.08) { // R√©duit de 20% √† 8%
                // Variation d'intensit√© plus douce
                const intensity = Math.random() * 0.15 + 0.04; // Entre 0.04 et 0.19 (plus subtil)
                noiseOverlay.style.opacity = intensity;
                
                // D√©calages plus subtils et moins fr√©quents
                if (Math.random() < 0.15) { // R√©duit de 30% √† 15%
                    noiseOverlay.style.transform = `translate(${Math.random() * 2 - 1}px, ${Math.random() * 2 - 1}px)`; // Plus petit
                    setTimeout(() => {
                        noiseOverlay.style.transform = 'translate(0px, 0px)';
                    }, Math.random() * 150 + 50);
                }
                
                setTimeout(() => {
                    noiseOverlay.style.opacity = '0.06';
                }, Math.random() * 500 + 200); // Dur√©e plus longue pour transition douce
            }
        }

        // Nouveau: Parasites de r√©ception occasionnels
        function receptionInterference() {
            if (Math.random() < 0.01) { // Plus fr√©quent, 1% de chance
                const terminal = document.querySelector('.terminal');
                const snowOverlay = document.querySelector('.snow-overlay');
                
                // Augmentation drastique du bruit pendant un court moment
                snowOverlay.style.opacity = Math.random() * 0.3 + 0.2; // Entre 0.2 et 0.5 (tr√®s visible)
                terminal.style.filter = 'blur(1.5px) contrast(1.8) brightness(1.5)'; // Plus intense
                
                setTimeout(() => {
                    snowOverlay.style.opacity = '0.1';
                    terminal.style.filter = 'blur(0.3px)';
                }, Math.random() * 400 + 300); // Dur√©e plus longue
            }
        }

        setInterval(addNoise, 30); // Plus fr√©quent
        setInterval(crtDistortion, 200); // Plus fr√©quent
        setInterval(colorArtifacts, 400); // Nouveau effet moins fr√©quent
        setInterval(analogInterference, 150); // Moins fr√©quent pour plus de subtilit√©
        setInterval(receptionInterference, 500); // Parasites plus fr√©quents

        // Initialisation au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            initializeBootSequence();
        });

        // Fonction pour initialiser la s√©quence de boot au premier chargement
        function initializeBootSequence() {
            // D√©marrer les effets de brouillage analogique
            createAnalogNoise();
            createTVSnow();
            
            // Attendre la fin de l'animation de boot (5 lignes * 0.4s d√©lai + 1s suppl√©mentaire)
            setTimeout(() => {
                isBootLoading = false;
                
                // Masquer la s√©quence de boot avec animation fluide
                const bootSequence = document.querySelector('.boot-sequence');
                if (bootSequence) {
                    bootSequence.style.opacity = '0';
                    setTimeout(() => {
                        bootSequence.style.display = 'none';
                    }, 500); // Attendre la fin de la transition
                }
                
                const bootInput = document.getElementById('command-input');
                if (bootInput) {
                    bootInput.disabled = false;
                }
                setupMainTerminal();
            }, 3000); // 3 secondes pour laisser le temps au boot de se terminer
        }

        // Appeler setupMainTerminal d√®s maintenant aussi (en cas de chargement sans DOMContentLoaded)
        if (document.readyState === 'loading') {
            // Document encore en cours de chargement, attendre DOMContentLoaded
        } else {
            // Document d√©j√† charg√©
            initializeBootSequence();
        }

        // Auto-scroll pendant le boot pour mobile
        function ensureBootScroll() {
            if (window.innerWidth <= 768) { // Sur mobile
                const outputContainer = document.querySelector('.output-container');
                const terminal = document.querySelector('.terminal');
                
                if (outputContainer) {
                    // Scroller vers le haut pour voir les nouvelles commandes
                    outputContainer.scrollTop = 0;
                }
                if (terminal) {
                    terminal.scrollTop = 0;
                }
            }
        }

        // Observer les changements dans le command-output pour auto-scroll
        if (window.innerWidth <= 768) {
            const bootObserver = new MutationObserver(() => {
                ensureBootScroll();
            });
            
            document.addEventListener('DOMContentLoaded', () => {
                const outputContainer = document.querySelector('.output-container');
                if (outputContainer) {
                    bootObserver.observe(outputContainer, { 
                        childList: true, 
                        subtree: true 
                    });
                }
            });
            
            // Auto-scroll p√©riodique pendant le boot
            const bootScrollInterval = setInterval(() => {
                if (isBootLoading) {
                    ensureBootScroll();
                } else {
                    clearInterval(bootScrollInterval);
                }
            }, 100);
        }

        // Gestion avanc√©e du clavier mobile
        let initialViewportHeight = window.visualViewport ? window.visualViewport.height : window.innerHeight;
        
        function handleViewportChange() {
            if (window.visualViewport) {
                const currentHeight = window.visualViewport.height;
                const heightDifference = initialViewportHeight - currentHeight;
                
                // Si la hauteur a diminu√© de plus de 150px, le clavier est probablement ouvert
                if (heightDifference > 150) {
                    setTimeout(() => {
                        const inputLine = document.querySelector('.input-line');
                        if (inputLine && !isLoginMode) {
                            inputLine.scrollIntoView({ 
                                behavior: 'smooth', 
                                block: 'end',
                                inline: 'nearest'
                            });
                        }
                    }, 100);
                }
            }
        }
        
        // √âcouter les changements de viewport (clavier mobile)
        if (window.visualViewport) {
            window.visualViewport.addEventListener('resize', handleViewportChange);
        } else {
            // Fallback pour les navigateurs plus anciens
            window.addEventListener('resize', handleViewportChange);
        }
    </script>
</body>
</html>
